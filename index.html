<!DOCTYPE html>
<html lang="en" style="font-family: aptos;">
<head>
  <meta charset="UTF-8">
  <title>4cast Weather</title>

  <link rel="apple-touch-icon" sizes="180x180" href="/assets/favicon/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/assets/favicon/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/assets/favicon/favicon-16x16.png">
  <link rel="manifest" href="/assets/favicon/manifest.json">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@400..700&display=swap" rel="stylesheet">

  <style>
    * { margin:0; padding:0; box-sizing:border-box; }
    :root { font-size:16px; }

    @font-face { font-family: aptos; src: url(/4cast/assets/aptos.ttf) format('truetype'); }
    @font-face { font-family: aptosBold; src: url(/4cast/assets/aptosBold.ttf) format('truetype'); }

    #header {
      position: fixed; top:0; left:0; right:0; z-index:100;
      font-size: clamp(0.1rem,10vw,10rem);
      font-family: 'Dancing Script', cursive;
      background-color: cornflowerblue;
      padding:1vh 5vw 0.5vh 2.5vw;
      display:grid; grid-template-columns:auto auto;
    }
    #location { text-align:right; align-self:end; font-family:aptosBold; font-size:clamp(0.1rem,5vw,10rem);}
    .sml { font-size:clamp(0.1rem,2vw,10rem); text-align:right; color:#555; }

    #scroll { margin-top: clamp(5rem,16vw,15rem); }

    #current {
      display:grid;
      grid-template-columns:1fr 2fr 2fr 0.5fr;
      font-size:clamp(0.1rem,4vw,10rem);
      white-space:nowrap;
      padding:0vh 5vw 1vh 0vw;
    }
    #current > div:nth-child(2) { grid-column:2; grid-row:1; }
    #current > div:nth-child(3) { grid-column:2; grid-row:2; }
    #current > div:nth-child(4) { grid-column:2; grid-row:3; }
    #current > div:nth-child(5) { grid-column:3; grid-row:2; }
    #current > div:nth-child(6) { grid-column:3; grid-row:3; }
    #current > div:nth-child(7) { grid-column:4; grid-row:2; }
    #current > div:nth-child(8) { grid-column:5; grid-row:2; }



    #icon { font-size:clamp(0.1rem,10vw,10rem); grid-row:span 3; align-self:center; padding-right:1vw; }
    #icon4 { font-size:clamp(0.1rem,7.5vw,10rem); grid-row:span 2; align-self:center; padding-right:1vw; }

    #tempObs { font-size:clamp(0.1rem,5vw,10rem); font-weight:bold; }
    #tempApp { font-size:clamp(0.1rem,4vw,10rem); font-weight:bold; }

    .min-temp {
      background-color: cornflowerblue;
      border-radius: 0.5pc 0 0 0.5pc;
      align-self: center;
      text-align: center;
      padding: 0.75vh;
    }

    .max-temp {
      background-color: red;
      border-radius: 0 0.5pc 0.5pc 0;
      align-self: center;
      text-align: center;
      padding: 0.75vh;
    }


    .feels { font-size:clamp(0.1rem,3vw,10rem); padding-left:0.25vw; color:#555; }

    .forecast-day {
      display: grid;
      grid-template-columns: 1fr 3fr 2fr;
      grid-template-rows: auto auto auto;
      font-size: clamp(0.1rem, 4vw, 10rem);
      white-space: nowrap;
      padding: 0vh 5vw 1vh 0vw;
    }

    .forecast-day > .icon { grid-column: 1; grid-row: 1 / span 3; align-self: center; padding-right: 1vw; }
    .forecast-day > .date { grid-column: 2; grid-row: 1; }
    .forecast-day > .description { grid-column: 2; grid-row: 2; }
    .forecast-day > .min-temp { grid-column: 3; grid-row: 1; }
    .forecast-day > .max-temp { grid-column: 4; grid-row: 1; }



  </style>
</head>

<body>
  <div id="header">4cast
    <div id="location">Noarlunga
      <div id="updated" class="sml"></div>
    </div>
  </div>

  <div id="scroll">
    <!-- CURRENT WEATHER -->
    <div id="current">
      <div id="icon">‚òÄÔ∏è</div>
      <div id="today">Loading date...</div>
      <div id="tempObs">Loading...</div>
      <div id="cloud" class="feels">Loading...</div>
      <div id="tempApp">Loading...</div>
      <div class="feels">Feels like</div>
      <div id="min">--</div>
      <div id="max">--</div>
    </div>

    <hr>

    <!-- FORECAST DAYS -->
    <div id="forecast-container">
      <!-- Repeat for 6 days -->
      <div class="forecast-grid" id="forecast-day1">
        <div id="forecast-day1-icon">‚òÄÔ∏è</div>
        <div id="forecast-day1-date">Loading...</div>
        <div id="forecast-day1-cloud" class="feels">Loading...</div>
        <div id="forecast-day1-min" class="min-temp">--</div>
        <div id="forecast-day1-max" class="max-temp">--</div>
      </div>

      <div class="forecast-grid" id="forecast-day2">
        <div id="forecast-day2-icon">‚òÄÔ∏è</div>
        <div id="forecast-day2-date">Loading...</div>
        <div id="forecast-day2-cloud" class="feels">Loading...</div>
        <div id="forecast-day2-min" class="min-temp">--</div>
        <div id="forecast-day2-max" class="max-temp">--</div>
      </div>

      <div class="forecast-grid" id="forecast-day3">
        <div id="forecast-day3-icon">‚òÄÔ∏è</div>
        <div id="forecast-day3-date">Loading...</div>
        <div id="forecast-day3-cloud" class="feels">Loading...</div>
        <div id="forecast-day3-min" class="min-temp">--</div>
        <div id="forecast-day3-max" class="max-temp">--</div>
      </div>

      <div class="forecast-grid" id="forecast-day4">
        <div id="forecast-day4-icon">‚òÄÔ∏è</div>
        <div id="forecast-day4-date">Loading...</div>
        <div id="forecast-day4-cloud" class="feels">Loading...</div>
        <div id="forecast-day4-min" class="min-temp">--</div>
        <div id="forecast-day4-max" class="max-temp">--</div>
      </div>

      <div class="forecast-grid" id="forecast-day5">
        <div id="forecast-day5-icon">‚òÄÔ∏è</div>
        <div id="forecast-day5-date">Loading...</div>
        <div id="forecast-day5-cloud" class="feels">Loading...</div>
        <div id="forecast-day5-min" class="min-temp">--</div>
        <div id="forecast-day5-max" class="max-temp">--</div>
      </div>

      <div class="forecast-grid" id="forecast-day6">
        <div id="forecast-day6-icon">‚òÄÔ∏è</div>
        <div id="forecast-day6-date">Loading...</div>
        <div id="forecast-day6-cloud" class="feels">Loading...</div>
        <div id="forecast-day6-min" class="min-temp">--</div>
        <div id="forecast-day6-max" class="max-temp">--</div>
      </div>
    </div>
  </div>

<script>
async function loadWeather() {
  try {
    const res = await fetch("data/weather.json?t=" + new Date().getTime());
    const data = await res.json();

    // --- CURRENT WEATHER ---
    const current = data.current;
    document.getElementById("tempObs").textContent = current.air_temp.toFixed(1) + "¬∞C";
    document.getElementById("tempApp").textContent = current.apparent_temp.toFixed(1) + "¬∞C";
    document.getElementById("updated").textContent =
      "Updated: " + new Date(current.timestamp_local).toLocaleString();
    document.getElementById("today").textContent =
      new Date(current.timestamp_local).toLocaleDateString(undefined, { weekday: 'long', day:'numeric', month:'short' });

    // --- FORECAST ---
    data.forecast.forEach((day, i) => {
      const dayIndex = i + 1; // 1-based
      const dateElem = document.getElementById(`forecast-day${dayIndex}-date`);
      const minElem  = document.getElementById(`forecast-day${dayIndex}-min`);
      const maxElem  = document.getElementById(`forecast-day${dayIndex}-max`);
      const cloudElem= document.getElementById(`forecast-day${dayIndex}-cloud`);
      const iconElem = document.getElementById(`forecast-day${dayIndex}-icon`);

      if(dateElem) dateElem.textContent = new Date(day.date).toLocaleDateString(undefined, { weekday: 'long', day:'numeric', month:'short' });
      if(minElem) minElem.textContent = day.temp_min !== null ? day.temp_min + "¬∞" : "-";
      if(maxElem) maxElem.textContent = day.temp_max !== null ? day.temp_max + "¬∞" : "-";
      if(cloudElem) cloudElem.textContent = day.precis;
      if(iconElem) iconElem.innerHTML = getIcon(day.icon);
    });
  } catch(e) {
    console.error("Error loading weather:", e);
  }
}

// Simple icon mapping, expand to your full set
function getIcon(code) {
  const icons = { 1: "‚òÄÔ∏è", 2: "üå§Ô∏è", 3: "‚õÖ", 9: "üå¨Ô∏è" };
  return icons[code] || "‚ùì";
}

loadWeather();
</script>

</body>
</html>
